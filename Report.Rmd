---
title: "Canada Median Income"
author: "Minh Tran, Fahad Bhutta, Aktan Kenzhebay, Saba Abbasi"
date: "2025-11-19"
output: pdf_document
---


```{r, include = TRUE, message = FALSE, warning = FALSE, echo = FALSE}
library(dplyr)
library(ggplot2)
income <- read.csv("incomes_cleaned.csv", check.names = FALSE)

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, include = FALSE, message = FALSE, warning = FALSE}

library(mosaic)
library(tidyverse)
library(survey)
library(knitr)
library(dplyr)
library(ggplot2)
```
```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```


# Abstract

### This statistical study aims to determine patterns and trends in the median income of people living in Canada at two time periods: 2015 and 2020. The data used in the study was retrieved from Statistics Canada. 

### Through this study, we determined the difference (or lack thereof) in household income in specific scenarios such like time periods and household sizes/situations. From these findings, we hope to be able to make predictions and recommendations to relevant parties.

```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

# Introduction

The dataset chosen is Household Income Statistics by household type, and it includes households from all provinces and territories in Canada. The data was collected through a census, and it has data from broad, general areas like whole provinces, and smaller, more specific areas like cities. The census in which data was derived from was done in 2016 and 2021, and the median incomes provided was from 2015 and 2020 respectively.

### Link to dataset: https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=9810005701

## Research questions

**Question 1:** Is there a difference in median after tax household income between 2015 and 2020?

**Question 2:** Is there a significant difference in income between households of 5 or more people and 4 persons (in 2020)? Do households with 5 or more people earn more than households with 4 people?

**Question 3:** Is there a difference in median income between Households with and without children? Do households with children earn more than households without children?

## Variables selected: 

**Question 1:** Median household after-tax income (2015), Median household after-tax income (2020)

**Question 2:** Median household total income (2020), Household Size: '4 persons' and '5 or more persons'

**Question 3:** Median household total income (2020), Household type including census family structure: 'With children' and 'Without children'

### We excluded any rows that were had empty cells (missing values) or had a '0' in the Number of Households column. Since there are times when the column had data for 2016 and not 2021, or vice versa, we chose to completely remove any rows that had empty cells.



```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

# Statistical Results

## Question 1: Is there a difference in median after tax household income between 2015 and 2020?
```{r, include = TRUE, message = FALSE, warning = FALSE, echo = FALSE}
income_sub <- income%>%
  filter(GEO != 'Canada') %>%
  filter(!is.na(`Household type including census family structure  (11)`))

income_sub <- income%>%
  filter(
    !is.na(`Median household after-tax income (2020)`),
    !is.na(`Median household after-tax income (2015)`),
    `Median household after-tax income (2020)` != 0,
    `Median household after-tax income (2015)` != 0
  )

inc2020 <- income_sub$`Median household after-tax income (2020)`
inc2015 <- income_sub$`Median household after-tax income (2015)`


var_median_2020  <- var(inc2020)   
var_median_2015  <- var(inc2015)

summary(inc2020)
summary(inc2015)

var_median_2020
var_median_2015

test <- t.test(inc2020, inc2015, alternative = "two.sided", var.equal = FALSE)
test

p_val <- test$p.value
p_val

par(mfrow = c(2,1))
# Boxplots
box2020 = boxplot(inc2020, ylab = "Median After Tax Incomes", main = "Boxplot of 2020 Median After Tax Income")
box2015 = boxplot(inc2015, ylab = "Median After Tax Incomes", main = "Boxplot of 2015 Median After Tax Income")
par(mfrow = c(2,1))
# Histograms
hist2020 = hist(inc2020, xlab = "Median After Tax Incomes", main = "Histogram of 2020 median after taxincomes")
hist2015 = hist(inc2015, xlab = "Median After Tax Incomes", main = "Histogram of 2015 median after tax incomes")
par(mfrow = c(2,1))
# QQ Plots
qq2020 <- qqnorm(inc2020, main = "Normal Q-Q Plot for 2020 Median After Tax Income")
qqline2020 <- qqline(inc2020,col = "red")
qq2015 <- qqnorm(inc2015, main = "Normal Q-Q Plot for 2015 Median After Tax Income")
qqline2015 <- qqline(inc2015,col = "red")
```

We performed a Welch's two sample t-test since the population variance is unknown, with Null Hypothesis (H0) being the median is equal between 2015 and 2020 (inc2020 = inc2015), and the Alternative Hypothesis (H1) being the medians are not equal (inc2020 != inc2015).

The p-value outputted from the t-test is less than 2.2e-16, which is extremely small, much smaller than our significance level of 5%. Thus, we conclude that there is a difference in the Median After Tax Household Income between 2015 and 2020. 

Additionally, the confidence interval generated for the difference between 2020 and 2015 median after tax income (inc2020 - inc2015) is (8441.755,8813.442), which has positive upper and lower confidence limits. This suggests that we can be 95% confident in concluding that the Median Household After Tax Income is higher in 2020 than 2015.




```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

## Question 2: Is there a significant difference in income between households of 5 or more people and 4 persons (in 2020)?


```{r, include = TRUE, message = FALSE, warning = FALSE, echo = FALSE}
income_sub <- income %>%
  filter(GEO != 'Canada') %>%
  filter(
    `Household size (7)` %in% c("4 persons", "5 or more persons"),
    !is.na(`Median household total income (2020)`),
    `Median household total income (2020)` != 0
  )

# Attaching 4 persons household rows
inc4 <- income_sub %>%
  filter(`Household size (7)` == "4 persons") %>%
  pull(`Median household total income (2020)`)

# Attaching 5 or more persons household rows
inc5p <- income_sub%>%
  filter(`Household size (7)` == "5 or more persons") %>%
  pull(`Median household total income (2020)`)

var4 <- var(inc4)
var5p <- var(inc5p)

summary(inc4)
summary(inc5p)

var4
var5p

test <- t.test(inc4, inc5p, alternative = "two.sided", var.equal = FALSE)
test

p_val <- test$p.value
p_val

par(mfrow=c(3,2))

# Boxplots
box4 = boxplot(inc4, ylab = "Median income", main = "Boxplot of Median Income of 4 person housholds")
box5p = boxplot(inc5p, ylab = "Median income", main = "Boxplot of Median Income of 5 or more person housholds")

# Histograms
hist4 = hist(inc4, xlab = "Median Income", main = "Histogram of Median Income of 4 Person Households")
hist5p = hist(inc5p, xlab = "Median Income", main = "Histogram of Median Income of 5 or more Person Households")

# QQ plots
qq4 <- qqnorm(inc4, main = "Normal Q-Q Plot for Median income of 4 Person Households")
qqline4 <- qqline(inc4,col = "red")

qq5p <- qqnorm(inc5p, main = "Normal Q-Q Plot for Median income of 5 or more Person Households")
qqline5p <- qqline(inc5p, col = "red")


```

We performed a Welch's two sample t-test since the population variance is unknown. The Null Hypothesis (H0) is The median income between households of 4 persons and 5 or more persons are the same (inc4 = inc5p), and the Alternative Hypothesis (H1) is The median income are different.

The p-value we got was less than 2.2e-16, which is extremely small, much smaller than our significance level of 5%. Thus, we reject H0, and conclude that the Median Income between Households with 4 persons and 5 or more persons is different. 

Additionally, the 95% confidence interval for the difference between Median Income of 4 person and 5 plus person households (inc4 - inc5p) is (-6,252.363, -4,967.192). This indicates that we can be 95% confident that households with 4 persons earn less than household with 5 or more persons.



```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

## Question 3: Is there a difference in median income between Households with and without children? 

```{r, include = TRUE, message = FALSE, warning = FALSE, echo = FALSE}
# We check data by the Household type... column
income_sub <- income %>%
  filter(GEO != 'Canada') %>%
  filter(
    # Include the data if the row is 'Without children' or 'With children' 
    `Household type including census family structure  (11)` %in% c("Without children", "With children"),
    !is.na(`Median household total income (2020)`),
    `Median household total income (2020)` != 0
  )

# Attaching the data
without_children <- income_sub %>%
  filter(`Household type including census family structure  (11)` == "Without children") %>%
  pull(`Median household total income (2020)`)

with_children <- income_sub %>%
  filter(`Household type including census family structure  (11)` == "With children") %>%
  pull(`Median household total income (2020)`)

var_without <- var(without_children)
var_with <- var(with_children)

summary(without_children)
summary(with_children)

var_without
var_with

test <- t.test(without_children, with_children, alternative = "two.sided", var.equal = FALSE)
test

p_val <- test$p.value
p_val

par(mfrow=c(3,1))

# Boxplot
withoutbox <- boxplot(without_children, ylab = "Median income", main = "Boxplot of Median Income of Households Without Children in 2020")

# Histogram
withoutHist <- hist(without_children, xlab = "Median Income", main = "Histogram of Median Income of Households Without Children in 2020")

# QQ plot
qqwithout <- qqnorm(without_children, main = "Normal Q-Q Plot for Median Income of Household Without Children")
qqlinewithout <- qqline(without_children, col = "red")

par(mfrow=c(3,1))
# Boxplot
withbox <- boxplot(with_children, ylab = "Median income", main = "Boxplot of Median Income of Households With Children in 2020")

# Histogram
withHist <- hist(with_children, xlab = "Median Income", main = "Histogram of Median Income of Households With Children in 2020")

# QQ plot
qqwith <- qqnorm(with_children, main = "Normal Q-Q Plot for Median Income of Household Without Children")
qqlinewith <- qqline(with_children, col = "red")
```

We performed a Welch's two sample t-test since the population variance is unknown. The Null Hypothesis (H0) is there is no difference in median income between households with and without children (incW0 = incW) and the Alternative Hypothesis (H1) is the median household incomes are different (incW0 != incW).

The p-value is less than 2.2-e16, which is smaller than our significance level at 5%. Thus, we can conclude that the Median Household Income between Families with children and without children is different.

The 95% confidence interval for the difference between the median income (incW0 - incW) is (-41,005.23, -40025.42). Since both confidence limits are negative, we can conclude with 95% confidence that the median income of families who have children are higher than those without.

This makes sense since households who have children are typically able to handle the financial burden that comes with raising a child.



```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

# Conclusion and Future Direction

## Summary

1. **2015 vs 2020 after-tax household income**

   - The t-test shows a highly significant difference between 2015 and 2020 (p < 2.2e-16).
   - The 95% CI for (2020 - 2015) is (8441.755, 8813.442), entirely positive.
   - **Conclusion:** Median after-tax household income is higher in 2020 than in 2015.

2. **Household size: 4 persons vs 5+ persons (2020)**
   - The t-test again shows a highly significant difference (p < 2.2e-16).
   - The 95% CI for (4-person - 5+-person) income is (-6,252.363, -4,967.192), entirely negative.
   - **Conclusion:** Households with 5 or more people earn more on average than 4-person households.

3. **Households with vs without children**
   - The t-test finds a highly significant difference in income (p < 2.2e-16).
   - The 95% CI for (without children - with children) is (-41,005.23, -40025.42), all negative.
   - **Conclusion:** Households with children earn substantially more than households without children.


## Limitations

1. One limitation is  the dataset gives median incomes by region and household category, not individual households. Performing a t-test on median data would mean we are comparing the mean of medians, not the actual median. Hence, p-values and confidence intervals provide an approximation of the difference, not the true difference in population medians.

2.  Another limitation is  the dataset didn't have information for every single geographical location, which led to some rows either having 0 for Number of Households, and missing values for median incomes. One problem this could lead to is misrepresentation, since lower income regions could be missing, making my data more biased towards higher income areas

3.  Another limiation is this dataset did not have information on key characteristics that affect earning like education, age, employment status, number of earners. These characteristics could potentially improve the precision of the analysis.

## Possible extensions/improvements.

1.  Get raw, individual data instead of grouped data. This will allow us to perform a much more accurate test, and the result will represent the actual mean better.

2.  Unrealistic, but to get data from every region, and from every household. This will allow us to get accurate information on means and medians of each groups, which will provide an unskewed result that is representative of the whole population.

3.  Get more characteristics from each sampled household, so we can better determine trends and correlations.


```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

# Appendix (R code) 
# Note that each question is done in a seperate R script, will be provided upon request.

## Question 1: Is there a difference in median after tax household income between 2015 and 2020?

### Load libraries
```{r, include = TRUE, message = FALSE, warning = FALSE}
library(dplyr)
library(ggplot2)
```



### Read data
```{r, include = TRUE, message = FALSE, warning = FALSE}
income <- read.csv("incomes_cleaned.csv", check.names = FALSE)
```

### filter by the first 11 rows of each geographic region that is not Canada 

11 since these 11 rows have data of all household sizes

The difference between these rows are household types, e.g. Couple with  children, without children, one parent, two parent, etc
```{r, include = TRUE, message = FALSE, warning = FALSE}
income_sub <- income%>%
  filter(GEO != 'Canada') %>%
  filter(!is.na(`Household type including census family structure  (11)`))
```


### exclude any rows where income is 0 
```{r, include = TRUE, message = FALSE, warning = FALSE}
income_sub <- income%>%
  filter(
    !is.na(`Median household after-tax income (2020)`),
    !is.na(`Median household after-tax income (2015)`),
    `Median household after-tax income (2020)` != 0,
    `Median household after-tax income (2015)` != 0
  )
```

### getting the data from their columns
```{r, include = TRUE, message = FALSE, warning = FALSE}
inc2020 <- income_sub$`Median household after-tax income (2020)`
inc2015 <- income_sub$`Median household after-tax income (2015)`
```

### Summary Statistics & variances
```{r, include = TRUE, message = FALSE, warning = FALSE}

var_median_2020  <- var(inc2020)   
var_median_2015  <- var(inc2015)

summary(inc2020)
summary(inc2015)

var_median_2020
var_median_2015
```

### Two sample t-test (unequal variances)
#### T-test since we do not know the population variance 
```{r, include = TRUE, message = FALSE, warning = FALSE}
test <- t.test(inc2020, inc2015, alternative = "two.sided", var.equal = FALSE)
test

p_val <- test$p.value
p_val
```

Since P-value is smaller than 0.05, we reject H0 at 5% significance, and conclude that there is a difference in median after tax household income between 2020 and 2015.



### Assumptions

### Data is continuous:

### Data is independent:
#### This one is probably true since the data are from two different time periods


### Distribution of data is approximately normal:
#### We use boxplot, histogram and QQ plot for this

```{r, include = TRUE, message = FALSE, warning = FALSE, fig.align="center"}
# Boxplots
box2020 = boxplot(inc2020, ylab = "Median After Tax Incomes", main = "Boxplot of 2020 Median After Tax Income")
box2015 = boxplot(inc2015, ylab = "Median After Tax Incomes", main = "Boxplot of 2015 Median After Tax Income")

# Histograms
hist2020 = hist(inc2020, xlab = "Median After Tax Incomes", main = "Histogram of 2020 median after taxincomes")
hist2015 = hist(inc2015, xlab = "Median After Tax Incomes", main = "Histogram of 2015 median after tax incomes")

# QQ Plots
qq2020 <- qqnorm(inc2020, main = "Normal Q-Q Plot for 2020 Median After Tax Income")
qqline2020 <- qqline(inc2020,col = "red")
qq2015 <- qqnorm(inc2015, main = "Normal Q-Q Plot for 2015 Median After Tax Income")
qqline2015 <- qqline(inc2015,col = "red")
```



```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```


## Question 2: Is there a significant difference in income between households of 5 or more people and 4 persons (in 2020)?

### Load Libraries
```{r, include = TRUE, message = FALSE, warning = FALSE}
library(dplyr)
library(ggplot2)
```


### Getting data from file
```{r, include = TRUE, message = FALSE, warning = FALSE}
income <- read.csv("incomes_cleaned.csv", check.names = FALSE)
```

### Data from relevant rows only (rows where household size is '4 persons' and '5 or more persons')
```{r, include = TRUE, message = FALSE, warning = FALSE}
income_sub <- income %>%
  filter(GEO != 'Canada') %>%
  filter(
    `Household size (7)` %in% c("4 persons", "5 or more persons"),
    !is.na(`Median household total income (2020)`),
    `Median household total income (2020)` != 0
  )

# Attaching 4 persons household rows
inc4 <- income_sub %>%
  filter(`Household size (7)` == "4 persons") %>%
  pull(`Median household total income (2020)`)

# Attaching 5 or more persons household rows
inc5p <- income_sub%>%
  filter(`Household size (7)` == "5 or more persons") %>%
  pull(`Median household total income (2020)`)
```

### Summary statistics, variances
```{r, include = TRUE, message = FALSE, warning = FALSE}
var4 <- var(inc4)
var5p <- var(inc5p)

summary(inc4)
summary(inc5p)

var4
var5p
```

### Two Sample t-test (unequal variances)
### T-test since we do not know the population variance 
```{r, include = TRUE, message = FALSE, warning = FALSE}
test <- t.test(inc4, inc5p, alternative = "two.sided", var.equal = FALSE)
test

p_val <- test$p.value
p_val
```

Since the p-value is less than 0.05, we reject H0, and conclude that there is a difference in income between household of 4 persons and households of 5 or more persons


## Assumptions

### Data is continuous:


### Data is independent: Probably true since the two groups are very distinct (4 and 5 or more persons household)


### Data is normally distributed: We use boxplot, histogram, and qq plot
```{r, include = TRUE, message = FALSE, warning = FALSE}
par(mfrow=c(3,2))

# Boxplots
box4 = boxplot(inc4, ylab = "Median income", main = "Boxplot of Median Income of 4 person housholds")
box5p = boxplot(inc5p, ylab = "Median income", main = "Boxplot of Median Income of 5 or more person housholds")

# Histograms
hist4 = hist(inc4, xlab = "Median Income", main = "Histogram of Median Income of 4 Person Households")
hist5p = hist(inc5p, xlab = "Median Income", main = "Histogram of Median Income of 5 or more Person Households")

# QQ plots
qq4 <- qqnorm(inc4, main = "Normal Q-Q Plot for Median income of 4 Person Households")
qqline4 <- qqline(inc4,col = "red")

qq5p <- qqnorm(inc5p, main = "Normal Q-Q Plot for Median income of 5 or more Person Households")
qqline5p <- qqline(inc5p, col = "red")


```



```{r, results='asis', eval=(opts_knit$get('rmarkdown.pandoc.to') == 'latex'), echo = FALSE}
cat('\\pagebreak')
```

## Question 3: Is there a difference in median income between Households with and without children?

### Do households with children earn more than households without children?


### Load libraries
```{r, include = TRUE, message = FALSE, warning = FALSE}
library(dplyr)
library(ggplot2)
```

### Getting data
```{r, include = TRUE, message = FALSE, warning = FALSE}
income <- read.csv("incomes_cleaned.csv", check.names = FALSE)
```

### Filtering data
```{r, include = TRUE, message = FALSE, warning = FALSE}
# We check data by the Household type... column
income_sub <- income %>%
  filter(GEO != 'Canada') %>%
  filter(
    # Include the data if the row is 'Without children' or 'With children' 
    `Household type including census family structure  (11)` %in% c("Without children", "With children"),
    !is.na(`Median household total income (2020)`),
    `Median household total income (2020)` != 0
  )

# Attaching the data
without_children <- income_sub %>%
  filter(`Household type including census family structure  (11)` == "Without children") %>%
  pull(`Median household total income (2020)`)

with_children <- income_sub %>%
  filter(`Household type including census family structure  (11)` == "With children") %>%
  pull(`Median household total income (2020)`)
```

### Summary statistics & variances
```{r, include = TRUE, message = FALSE, warning = FALSE}
var_without <- var(without_children)
var_with <- var(with_children)

summary(without_children)
summary(with_children)

var_without
var_with
```

### Two Sample t-test (unequal variances)
#### T-test since we do not know the population variance 
```{r, include = TRUE, message = FALSE, warning = FALSE}
test <- t.test(without_children, with_children, alternative = "two.sided", var.equal = FALSE)
test

p_val <- test$p.value
p_val
```

Since the p-value of our t-test is less than 0.05, we reject H0, and conclude that there is a difference between the income of households with children and without children



## Assumptions

### Data is continuous:



### Data is independent: This is probably true since people with children wouldn't report that they don't have children when replying to a census, and vice versa



### Data is Normally distributed: We will use boxplots, histograms, and qq-plots to check this assumption


### Families without children

```{r, include = TRUE, message = FALSE, warning = FALSE}
par(mfrow=c(3,1))

# Boxplot
withoutbox <- boxplot(without_children, ylab = "Median income", main = "Boxplot of Median Income of Households Without Children in 2020")

# Histogram
withoutHist <- hist(without_children, xlab = "Median Income", main = "Histogram of Median Income of Households Without Children in 2020")

# QQ plot
qqwithout <- qqnorm(without_children, main = "Normal Q-Q Plot for Median Income of Household Without Children")
qqlinewithout <- qqline(without_children, col = "red")
```

### Families With Children
```{r, include = TRUE, message = FALSE, warning = FALSE}
par(mfrow=c(3,1))
# Boxplot
withbox <- boxplot(with_children, ylab = "Median income", main = "Boxplot of Median Income of Households With Children in 2020")

# Histogram
withHist <- hist(with_children, xlab = "Median Income", main = "Histogram of Median Income of Households With Children in 2020")

# QQ plot
qqwith <- qqnorm(with_children, main = "Normal Q-Q Plot for Median Income of Household Without Children")
qqlinewith <- qqline(with_children, col = "red")
```

